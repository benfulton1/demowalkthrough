<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Interior Elite Demolition Walkthrough v1.6</title>
  <!-- Montserrat font -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet"/>
  <style>
    body { font-family: 'Montserrat', sans-serif; background: #f4f4f4; color: #333; margin: 0; padding: 0; }
    .header { background: #E65C00; color: #fff; display: flex; align-items: center; padding: 10px 20px; }
    .header img { height: 40px; margin-right: 15px; }
    .header h1 { font-size: 1.5em; margin: 0; }
    .container { max-width: 800px; margin: 20px auto; padding: 20px; background: #fff; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    h2 { text-align: center; color: #E65C00; margin-bottom: 20px; }
    fieldset { border: 1px solid #ddd; border-radius: 8px; margin-bottom: 20px; padding: 15px; }
    legend { font-weight: 600; color: #444; font-size: 1.1em; }
    label { display: block; margin-bottom: 6px; font-weight: 500; }
    input[type="text"], input[type="tel"], textarea, select { width: 100%; padding: 8px; margin-bottom: 12px; border: 1px solid #ccc; border-radius: 4px; }
    textarea { min-height: 60px; resize: vertical; }
    .btn { display: block; width: 100%; padding: 12px; border: none; border-radius: 4px; font-weight: 600; cursor: pointer; margin-bottom: 12px; }
    .btn-primary { background: #E65C00; color: #fff; }
    .btn-primary:hover { background: #cc5000; }
    .btn-secondary { background: #007ACC; color: #fff; }
    .btn-secondary:hover { background: #006bb3; }
    .btn-custom { background: #444; color: #fff; }
    .btn-custom:hover { background: #333; }
    .personnel-item, .checklist-item, .task-item { display: flex; flex-wrap: wrap; align-items: center; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid #eee; }
    .personnel-item select { flex: 0 0 30%; margin-right: 10px; }
    .personnel-item input { flex: 0 0 calc(35% - 10px); margin-right: 10px; }
    .checklist-item label, .task-item label { flex: 1; display: flex; align-items: center; }
    .checklist-item label input, .task-item label input { margin-right: 8px; }
    .note-input { width: 100%; padding: 6px; margin-top: 6px; border: 1px solid #ccc; border-radius: 4px; display: none; }
    .task-controls { margin-left: auto; }
    .task-controls select { padding: 6px; border-radius: 4px; border: 1px solid #ccc; }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <header class="header">
    <img src="https://kamloopsbuilders.ca/assets/logo.png" alt="Interior Elite Logo">
    <h1>Interior Elite Contracting</h1>
  </header>
  <div class="container" id="mainContainer">
    <h2>Demolition Walkthrough v1.6</h2>
    <form id="demoForm">
      <fieldset>
        <legend>Project Info</legend>
        <label>Site Address<input type="text" id="siteAddress" placeholder="Enter site address"></label>
        <label>Client Name<input type="text" id="clientName" placeholder="Enter client name"></label>
        <button type="button" id="captureLocationBtn" class="btn btn-custom">Capture Site Location</button>
        <div id="siteLocationDisplay" style="margin-bottom:12px;font-size:0.9em;color:#555;"></div>
      </fieldset>
      <fieldset>
        <legend>Personnel on Site</legend>
        <button type="button" id="addPersonnelBtn" class="btn btn-primary">+ Add Personnel</button>
        <div id="personnelContainer"></div>
      </fieldset>
      <fieldset>
        <legend>Site Conditions</legend>
        <div id="siteConditionsList"></div>
      </fieldset>
      <fieldset>
        <legend>Site Security</legend>
        <div id="siteSecurityList"></div>
      </fieldset>
      <fieldset>
        <legend>Special Client Requests</legend>
        <div id="specialRequestsList"></div>
      </fieldset>
      <fieldset>
        <legend>Rooms & Tasks</legend>
        <button type="button" id="addRoomBtn" class="btn btn-primary">+ Add Room</button>
        <div id="roomsContainer"></div>
      </fieldset>
      <button type="button" id="toPdfBtn" class="btn btn-secondary">Convert to PDF</button>
      <button type="button" id="toWorkOrderBtn" class="btn btn-secondary">Convert to Work Order</button>
    </form>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const peopleTypes = ["Project Manager", "Designer", "Client"];
      const roomList = ["Bathroom","Kitchen","Living Room","Bedroom","Dining Room","Home Office","Laundry Room","Garage","Basement","Attic","Patio","Deck","Porch","Hallway","Entryway","Staircase","Exterior Walls","Driveway","Sidewalk","Landscaping Area","Roof"];
      const standardTasks = ["Remove wall drywall","Remove ceiling drywall","Remove flooring","Remove doors","Remove trim/moulding","Remove baseboard trim","Asbestos review","Disconnect utilities","General cleanup","Debris removal"];
      const roomSpecificTasks = {
        "Bathroom":["Remove toilet","Remove bathtub/shower","Remove vanity","Remove countertop","Remove sink","Remove mirror","Remove medicine cabinet","Remove tile from walls","Remove tile from floor","Remove plumbing fixtures"],
        "Kitchen":["Remove cabinets","Remove countertops","Remove sink","Remove faucet","Remove appliances","Remove backsplash tile","Remove lighting fixtures","Remove island","Remove hood","Remove dishwasher"],
        "Living Room":["Remove drywall","Remove flooring","Remove trim","Remove baseboards","Remove windows","Remove built-in shelves","Remove fireplace","Remove lighting fixtures","Remove wall coverings","Remove vents"],
        "Bedroom":["Remove drywall","Remove flooring","Remove trim","Remove baseboards","Remove windows","Remove closet shelving","Remove lighting fixtures","Remove built-in furniture","Remove outlets","Remove vents"],
        "Dining Room":["Remove drywall","Remove flooring","Remove trim","Remove baseboards","Remove lighting fixtures","Remove built-in features","Remove chandelier","Remove paint","Remove curtains","Remove outlets"],
        "Home Office":["Remove drywall","Remove flooring","Remove trim","Remove baseboards","Remove built-in desks","Remove lighting fixtures","Remove data outlets","Remove shelving","Remove whiteboards","Remove outlets"],
        "Laundry Room":["Remove washer/dryer","Remove cabinets","Remove sink","Remove plumbing fixtures","Remove flooring","Remove lighting fixtures","Remove ventilation fan","Remove tile","Remove shelving","Remove outlets"],
        "Garage":["Remove drywall","Remove shelving","Remove cabinets","Remove doors","Remove windows","Remove lighting fixtures","Remove electrical fixtures","Remove insulation","Remove hooks","Remove signage"],
        "Basement":["Remove drywall","Remove flooring","Remove insulation","Remove trim","Remove lighting fixtures","Remove windows","Remove sump pump cover","Remove tile","Remove shelving","Remove outlets"],
        "Attic":["Remove insulation","Remove drywall","Remove flooring","Remove vents","Remove lighting fixtures","Remove bracing","Remove panels","Remove wiring","Remove ductwork","Remove hatch"],
        "Patio":["Remove pavers","Remove decking","Remove railings","Remove lighting fixtures","Remove outdoor furniture","Remove pergola","Remove planters","Remove fixtures","Remove coverings","Remove posts"],
        "Deck":["Remove deck boards","Remove railings","Remove stairs","Remove lighting fixtures","Remove posts","Remove joists","Remove skirting","Remove hardware","Remove fascia","Remove supports"],
        "Porch":["Remove flooring","Remove railings","Remove columns","Remove lighting fixtures","Remove door frame","Remove ceiling","Remove trim","Remove steps","Remove fixtures","Remove soffit"],
        "Hallway":["Remove drywall","Remove flooring","Remove trim","Remove baseboards","Remove lighting fixtures","Remove railings","Remove sconces","Remove outlets","Remove vents","Remove doors"],
        "Entryway":["Remove flooring","Remove trim","Remove lighting fixtures","Remove closet shelving","Remove doors","Remove hardware","Remove baseboards","Remove outlets","Remove vents","Remove paint"],
        "Staircase":["Remove treads","Remove risers","Remove handrails","Remove balusters","Remove lighting fixtures","Remove carpet","Remove hardware","Remove trim","Remove landing","Remove fixture"],
        "Exterior Walls":["Remove cladding","Remove siding","Remove fascia","Remove soffit","Remove windows","Remove trim","Remove vents","Remove fixtures","Remove caulking","Remove flashings"],
        "Driveway":["Remove concrete","Remove asphalt","Remove pavers","Remove sealant","Remove markings","Remove curbing","Re]()

